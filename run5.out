[a100:159520] mca_base_component_repository_open: unable to open mca_btl_openib: librdmacm.so.1: cannot open shared object file: No such file or directory (ignored)
loading drawing model...
loading semseg model...
/home/wgy/miniconda3/envs/mumo/lib/python3.9/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3526.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
self.task_switch  {'coco': True, 'o365': False}
loading panoseg model...
self.task_switch  {'coco': True, 'o365': False}
loading classifier...
loading pos tagger...
2023-12-07 12:25:22 INFO: Checking for updates to resources.json in case models have been updated.  Note: this behavior can be turned off with download_method=None or download_method=DownloadMethod.REUSE_RESOURCES
Downloading https://raw.githubusercontent.com/stanfordnlp/stanza-resources/main/resources_1.7.0.json:   0%|          | 0.00/46.0k [00:00<?, ?B/s]Downloading https://raw.githubusercontent.com/stanfordnlp/stanza-resources/main/resources_1.7.0.json: 369kB [00:00, 2.61MB/s]                    Downloading https://raw.githubusercontent.com/stanfordnlp/stanza-resources/main/resources_1.7.0.json: 369kB [00:00, 2.61MB/s]
2023-12-07 12:25:22 WARNING: Language en package default expects mwt, which has been added
2023-12-07 12:25:23 INFO: Loading these models for language: en (English):
===============================
| Processor | Package         |
-------------------------------
| tokenize  | combined        |
| mwt       | combined        |
| pos       | combined_charlm |
===============================

2023-12-07 12:25:23 INFO: Using device: cuda
2023-12-07 12:25:23 INFO: Loading: tokenize
2023-12-07 12:25:23 INFO: Loading: mwt
2023-12-07 12:25:23 INFO: Loading: pos
2023-12-07 12:25:23 INFO: Done loading processors!
loading models completed
  0%|          | 0/47 [00:00<?, ?it/s]Extracting target objs from caption...
target_objs: [{'obj': 'dog', 'num': 1, 'color': [0, 192, 0]}, {'obj': 'fire hydrant', 'num': 1, 'color': [192, 128, 0]}]
caption_objs: ['dog', 'fire hydrant']
Extracting target objs...
Adjusting layout...

  0%|          | 0/49 [00:00<?, ?it/s][A
  2%|▏         | 1/49 [00:19<15:32, 19.44s/it][A
  4%|▍         | 2/49 [00:39<15:20, 19.58s/it][A
  6%|▌         | 3/49 [00:58<14:57, 19.51s/it][A
  8%|▊         | 4/49 [01:17<14:27, 19.27s/it][A
 10%|█         | 5/49 [01:37<14:12, 19.38s/it][A
 12%|█▏        | 6/49 [01:56<13:53, 19.39s/it][A
 14%|█▍        | 7/49 [02:15<13:36, 19.44s/it][A
 16%|█▋        | 8/49 [02:36<13:35, 19.88s/it][A
 18%|█▊        | 9/49 [02:57<13:20, 20.02s/it][A
 20%|██        | 10/49 [03:16<12:57, 19.93s/it][A
 22%|██▏       | 11/49 [03:36<12:31, 19.77s/it][A
 24%|██▍       | 12/49 [03:55<12:10, 19.74s/it][A
 27%|██▋       | 13/49 [04:15<11:50, 19.73s/it][A
 29%|██▊       | 14/49 [04:35<11:29, 19.69s/it][A
 31%|███       | 15/49 [04:54<11:04, 19.54s/it][A
 33%|███▎      | 16/49 [05:14<10:47, 19.61s/it][A
 35%|███▍      | 17/49 [05:34<10:30, 19.70s/it][A
 37%|███▋      | 18/49 [05:53<10:11, 19.71s/it][A
 39%|███▉      | 19/49 [06:13<09:50, 19.69s/it][A
 41%|████      | 20/49 [06:32<09:27, 19.57s/it][A
 43%|████▎     | 21/49 [06:52<09:07, 19.57s/it][A
 45%|████▍     | 22/49 [07:11<08:48, 19.56s/it][A
 47%|████▋     | 23/49 [07:31<08:27, 19.53s/it][A
 49%|████▉     | 24/49 [07:52<08:22, 20.11s/it][A
 51%|█████     | 25/49 [08:13<08:03, 20.14s/it][A
 53%|█████▎    | 26/49 [08:32<07:39, 19.97s/it][A
 55%|█████▌    | 27/49 [08:52<07:16, 19.84s/it][A
 57%|█████▋    | 28/49 [09:11<06:56, 19.82s/it][A
 59%|█████▉    | 29/49 [09:31<06:35, 19.77s/it][A
 61%|██████    | 30/49 [09:50<06:13, 19.64s/it][A
 63%|██████▎   | 31/49 [10:10<05:55, 19.75s/it][A
 65%|██████▌   | 32/49 [10:30<05:35, 19.74s/it][A
 67%|██████▋   | 33/49 [10:50<05:15, 19.71s/it][A
 69%|██████▉   | 34/49 [11:09<04:53, 19.58s/it][A
 71%|███████▏  | 35/49 [11:29<04:35, 19.67s/it][A
 73%|███████▎  | 36/49 [11:48<04:11, 19.35s/it][A
 76%|███████▌  | 37/49 [12:07<03:53, 19.44s/it][A
 78%|███████▊  | 38/49 [12:27<03:33, 19.42s/it][A
 80%|███████▉  | 39/49 [12:46<03:15, 19.53s/it][A
 82%|████████▏ | 40/49 [13:06<02:55, 19.48s/it][A
 84%|████████▎ | 41/49 [13:26<02:36, 19.59s/it][A
 86%|████████▌ | 42/49 [13:45<02:17, 19.59s/it][A
 88%|████████▊ | 43/49 [14:05<01:57, 19.62s/it][A
 90%|████████▉ | 44/49 [14:24<01:38, 19.63s/it][A
 92%|█████████▏| 45/49 [14:44<01:18, 19.68s/it][A
 94%|█████████▍| 46/49 [15:04<00:59, 19.74s/it][A
 96%|█████████▌| 47/49 [15:24<00:39, 19.69s/it][A
 98%|█████████▊| 48/49 [15:43<00:19, 19.71s/it][A
100%|██████████| 49/49 [16:03<00:00, 19.79s/it][A100%|██████████| 49/49 [16:03<00:00, 19.67s/it]
Generating new images...

  0%|          | 0/50 [00:00<?, ?it/s][A
  2%|▏         | 1/50 [01:10<57:46, 70.74s/it][A
  4%|▍         | 2/50 [02:21<56:30, 70.64s/it][A
  6%|▌         | 3/50 [03:31<55:12, 70.47s/it][A
  8%|▊         | 4/50 [04:41<53:56, 70.36s/it][A
 10%|█         | 5/50 [05:52<52:48, 70.42s/it][A
 12%|█▏        | 6/50 [07:02<51:32, 70.29s/it][A
 14%|█▍        | 7/50 [08:12<50:18, 70.20s/it][A
 16%|█▌        | 8/50 [09:22<49:09, 70.23s/it][A
 18%|█▊        | 9/50 [10:32<47:59, 70.24s/it][A
 20%|██        | 10/50 [11:43<46:51, 70.29s/it][A
 22%|██▏       | 11/50 [12:53<45:41, 70.29s/it][A
 24%|██▍       | 12/50 [14:03<44:32, 70.32s/it][A
 26%|██▌       | 13/50 [15:14<43:22, 70.34s/it][A
 28%|██▊       | 14/50 [16:25<42:16, 70.45s/it][A
 30%|███       | 15/50 [17:35<41:06, 70.46s/it][A
 32%|███▏      | 16/50 [18:45<39:50, 70.31s/it][A
 34%|███▍      | 17/50 [19:55<38:41, 70.36s/it][A
 36%|███▌      | 18/50 [21:06<37:31, 70.37s/it][A
 38%|███▊      | 19/50 [22:16<36:18, 70.28s/it][A
 40%|████      | 20/50 [23:26<35:05, 70.19s/it][A
 42%|████▏     | 21/50 [24:36<33:58, 70.29s/it][A
 44%|████▍     | 22/50 [25:47<32:47, 70.28s/it][A
 46%|████▌     | 23/50 [26:57<31:36, 70.23s/it][A
 48%|████▊     | 24/50 [28:07<30:28, 70.34s/it][A
 50%|█████     | 25/50 [29:18<29:16, 70.27s/it][A
 52%|█████▏    | 26/50 [30:28<28:07, 70.32s/it][A
 54%|█████▍    | 27/50 [31:38<26:57, 70.34s/it][A
 56%|█████▌    | 28/50 [32:48<25:45, 70.26s/it][A
 58%|█████▊    | 29/50 [33:59<24:38, 70.39s/it][A
 60%|██████    | 30/50 [35:09<23:26, 70.33s/it][A
 62%|██████▏   | 31/50 [36:20<22:16, 70.36s/it][A
 64%|██████▍   | 32/50 [37:30<21:05, 70.28s/it][A
 66%|██████▌   | 33/50 [38:40<19:52, 70.12s/it][A
 68%|██████▊   | 34/50 [39:50<18:41, 70.10s/it][A
 70%|███████   | 35/50 [41:00<17:30, 70.04s/it][A
 72%|███████▏  | 36/50 [42:10<16:22, 70.15s/it][A
 74%|███████▍  | 37/50 [43:20<15:12, 70.19s/it][A
 76%|███████▌  | 38/50 [44:30<14:02, 70.21s/it][A
 78%|███████▊  | 39/50 [45:41<12:54, 70.42s/it][A
 80%|████████  | 40/50 [46:32<10:43, 64.39s/it][A
 82%|████████▏ | 41/50 [47:14<08:40, 57.79s/it][A
 84%|████████▍ | 42/50 [47:57<07:06, 53.27s/it][A
 86%|████████▌ | 43/50 [48:39<05:50, 50.05s/it][A
 88%|████████▊ | 44/50 [49:22<04:46, 47.73s/it][A
 90%|█████████ | 45/50 [50:04<03:50, 46.17s/it][A
 92%|█████████▏| 46/50 [50:47<03:00, 45.16s/it][A
 94%|█████████▍| 47/50 [51:30<02:13, 44.44s/it][A
 96%|█████████▌| 48/50 [52:13<01:27, 43.94s/it][A
 98%|█████████▊| 49/50 [52:55<00:43, 43.58s/it][A
100%|██████████| 50/50 [53:38<00:00, 43.37s/it][A100%|██████████| 50/50 [53:38<00:00, 64.37s/it]
Total: 4195.957488536835s
 11%|█         | 5/47 [1:09:55<9:47:26, 839.19s/it]Extracting target objs from caption...
target_objs: [{'obj': 'cup', 'num': 1, 'color': [192, 128, 192]}, {'obj': 'knife', 'num': 1, 'color': [128, 64, 64]}]
caption_objs: ['coffee cup', 'knife']
Extracting target objs...
Adjusting layout...

  0%|          | 0/49 [00:00<?, ?it/s][A
  2%|▏         | 1/49 [00:11<08:54, 11.15s/it][A
  4%|▍         | 2/49 [00:22<08:54, 11.37s/it][A
  6%|▌         | 3/49 [00:34<08:44, 11.40s/it][A
  8%|▊         | 4/49 [00:45<08:35, 11.44s/it][A
 10%|█         | 5/49 [00:57<08:25, 11.48s/it][A
 12%|█▏        | 6/49 [01:08<08:16, 11.55s/it][A
 14%|█▍        | 7/49 [01:20<08:06, 11.59s/it][A
 16%|█▋        | 8/49 [01:32<07:54, 11.57s/it][A
 18%|█▊        | 9/49 [01:43<07:39, 11.48s/it][A
 20%|██        | 10/49 [01:54<07:27, 11.47s/it][A
 22%|██▏       | 11/49 [02:06<07:14, 11.44s/it][A
 24%|██▍       | 12/49 [02:17<07:04, 11.47s/it][A
 27%|██▋       | 13/49 [02:29<06:55, 11.54s/it][A
 29%|██▊       | 14/49 [02:40<06:44, 11.54s/it][A
 31%|███       | 15/49 [02:52<06:32, 11.54s/it][A
 33%|███▎      | 16/49 [03:04<06:23, 11.63s/it][A
 35%|███▍      | 17/49 [03:17<06:29, 12.16s/it][A
 37%|███▋      | 18/49 [03:29<06:14, 12.09s/it][A
 39%|███▉      | 19/49 [03:41<05:56, 11.90s/it][A
 41%|████      | 20/49 [03:52<05:42, 11.80s/it][A
 43%|████▎     | 21/49 [04:04<05:28, 11.73s/it][A
 45%|████▍     | 22/49 [04:15<05:13, 11.59s/it][A
 47%|████▋     | 23/49 [04:26<04:58, 11.48s/it][A
 49%|████▉     | 24/49 [04:38<04:45, 11.43s/it][A
 51%|█████     | 25/49 [04:49<04:34, 11.46s/it][A
 53%|█████▎    | 26/49 [05:00<04:21, 11.37s/it][A
 55%|█████▌    | 27/49 [05:12<04:09, 11.35s/it][A
 57%|█████▋    | 28/49 [05:23<03:58, 11.36s/it][A
 59%|█████▉    | 29/49 [05:34<03:48, 11.40s/it][A
 61%|██████    | 30/49 [05:46<03:35, 11.35s/it][A
 63%|██████▎   | 31/49 [05:57<03:23, 11.32s/it][A
 65%|██████▌   | 32/49 [06:08<03:11, 11.29s/it][A
 67%|██████▋   | 33/49 [06:19<03:00, 11.28s/it][A
 69%|██████▉   | 34/49 [06:30<02:48, 11.23s/it][A
 71%|███████▏  | 35/49 [06:42<02:38, 11.29s/it][A
 73%|███████▎  | 36/49 [06:53<02:27, 11.32s/it][A
 76%|███████▌  | 37/49 [07:05<02:16, 11.34s/it][A
 78%|███████▊  | 38/49 [07:16<02:04, 11.35s/it][A
 80%|███████▉  | 39/49 [07:27<01:53, 11.34s/it][A
 82%|████████▏ | 40/49 [07:39<01:44, 11.57s/it][A
 84%|████████▎ | 41/49 [07:52<01:35, 11.98s/it][A
 86%|████████▌ | 42/49 [08:04<01:22, 11.86s/it][A
 88%|████████▊ | 43/49 [08:15<01:10, 11.68s/it][A
 90%|████████▉ | 44/49 [08:27<00:57, 11.57s/it][A
 92%|█████████▏| 45/49 [08:38<00:45, 11.46s/it][A
 94%|█████████▍| 46/49 [08:49<00:34, 11.42s/it][A
 96%|█████████▌| 47/49 [09:00<00:22, 11.40s/it][A
 98%|█████████▊| 48/49 [09:11<00:11, 11.26s/it][A
100%|██████████| 49/49 [09:23<00:00, 11.22s/it][A100%|██████████| 49/49 [09:23<00:00, 11.49s/it]
Generating new images...

  0%|          | 0/50 [00:00<?, ?it/s][A
  2%|▏         | 1/50 [01:09<56:56, 69.71s/it][A
  4%|▍         | 2/50 [02:19<55:39, 69.57s/it][A
  6%|▌         | 3/50 [03:29<54:37, 69.74s/it][A
  8%|▊         | 4/50 [04:38<53:22, 69.62s/it][A
 10%|█         | 5/50 [05:48<52:17, 69.72s/it][A
 12%|█▏        | 6/50 [06:57<51:04, 69.64s/it][A
 14%|█▍        | 7/50 [08:07<49:51, 69.57s/it][A
 16%|█▌        | 8/50 [09:17<48:46, 69.68s/it][A
 18%|█▊        | 9/50 [10:27<47:39, 69.74s/it][A
 20%|██        | 10/50 [11:37<46:32, 69.82s/it][A
 22%|██▏       | 11/50 [12:46<45:19, 69.72s/it][A
 24%|██▍       | 12/50 [13:56<44:09, 69.72s/it][A
 26%|██▌       | 13/50 [15:05<42:55, 69.60s/it][A
 28%|██▊       | 14/50 [16:15<41:48, 69.67s/it][A
 30%|███       | 15/50 [17:25<40:40, 69.72s/it][A
 32%|███▏      | 16/50 [18:35<39:29, 69.70s/it][A
 34%|███▍      | 17/50 [19:44<38:17, 69.61s/it][A
 36%|███▌      | 18/50 [20:53<37:05, 69.56s/it][A
 38%|███▊      | 19/50 [22:03<35:57, 69.59s/it][A
 40%|████      | 20/50 [23:12<34:46, 69.54s/it][A
 42%|████▏     | 21/50 [24:22<33:37, 69.57s/it][A
 44%|████▍     | 22/50 [25:32<32:27, 69.55s/it][A
 46%|████▌     | 23/50 [26:41<31:19, 69.63s/it][A
 48%|████▊     | 24/50 [27:51<30:10, 69.65s/it][A
 50%|█████     | 25/50 [29:00<28:59, 69.56s/it][A
 52%|█████▏    | 26/50 [30:10<27:51, 69.66s/it][A
 54%|█████▍    | 27/50 [31:20<26:41, 69.64s/it][A
 56%|█████▌    | 28/50 [32:30<25:33, 69.69s/it][A
 58%|█████▊    | 29/50 [33:39<24:23, 69.70s/it][A
 60%|██████    | 30/50 [34:49<23:13, 69.67s/it][A
 62%|██████▏   | 31/50 [35:59<22:02, 69.61s/it][A
 64%|██████▍   | 32/50 [37:08<20:54, 69.69s/it][A
 66%|██████▌   | 33/50 [38:18<19:45, 69.72s/it][A
 68%|██████▊   | 34/50 [39:28<18:34, 69.65s/it][A
 70%|███████   | 35/50 [40:37<17:25, 69.69s/it][A
 72%|███████▏  | 36/50 [41:47<16:15, 69.67s/it][A
 74%|███████▍  | 37/50 [42:57<15:05, 69.65s/it][A
 76%|███████▌  | 38/50 [44:06<13:55, 69.61s/it][A
 78%|███████▊  | 39/50 [45:16<12:45, 69.58s/it][A
 80%|████████  | 40/50 [46:26<11:36, 69.65s/it][A
 82%|████████▏ | 41/50 [47:35<10:27, 69.73s/it][A
 84%|████████▍ | 42/50 [48:45<09:18, 69.81s/it][A
 86%|████████▌ | 43/50 [49:40<07:36, 65.28s/it][A
 88%|████████▊ | 44/50 [50:22<05:49, 58.24s/it][A
 90%|█████████ | 45/50 [51:04<04:26, 53.34s/it][A
 92%|█████████▏| 46/50 [51:46<03:20, 50.02s/it][A
 94%|█████████▍| 47/50 [52:28<02:22, 47.58s/it][A
 96%|█████████▌| 48/50 [53:10<01:31, 45.82s/it][A
 98%|█████████▊| 49/50 [53:52<00:44, 44.69s/it][A
100%|██████████| 50/50 [54:34<00:00, 43.90s/it][A100%|██████████| 50/50 [54:34<00:00, 65.49s/it]
Total: 3846.7417862415314s
 23%|██▎       | 11/47 [2:14:02<7:08:27, 714.10s/it]Extracting target objs from caption...
target_objs: [{'obj': 'cat', 'num': 1, 'color': [128, 64, 0]}, {'obj': 'couch', 'num': 1, 'color': [192, 192, 192]}, {'obj': 'mouse', 'num': 1, 'color': [96, 128, 0]}]
caption_objs: ['cat', 'couch', 'computer mouse']
Extracting target objs...
Adjusting layout...

  0%|          | 0/49 [00:00<?, ?it/s][A  0%|          | 0/49 [00:01<?, ?it/s]
--------error--------
Traceback (most recent call last):
  File "/home/wgy/multimodal/MuMo/run5.py", line 442, in <module>
    editor(image_dir=obj_image_path, output_path=mask_dir, step=10, gen_num=49)
  File "/home/wgy/multimodal/MuMo/layout_editor.py", line 203, in editor
    obj_list = get_obj_img(image_dir=image_dir, image_list=all_img)
  File "/home/wgy/multimodal/MuMo/layout_editor.py", line 133, in get_obj_img
    info = read_obj_info(mask)
  File "/home/wgy/multimodal/MuMo/layout_editor.py", line 119, in read_obj_info
    obj_info["x_max"] = max(point_x_set)
ValueError: max() arg is an empty sequence
---------------------
Total: 15.604182243347168s
 36%|███▌      | 17/47 [2:14:18<3:08:18, 376.63s/it]Extracting target objs from caption...
target_objs: [{'obj': 'teddy bear', 'num': 1, 'color': [96, 64, 0]}, {'obj': 'chair', 'num': 1, 'color': [64, 192, 192]}]
caption_objs: ['teddy bear', 'chair']
Extracting target objs...
Adjusting layout...

  0%|          | 0/49 [00:00<?, ?it/s][A
  2%|▏         | 1/49 [00:12<09:41, 12.11s/it][A
  4%|▍         | 2/49 [00:25<10:03, 12.85s/it][A
  6%|▌         | 3/49 [00:38<09:49, 12.81s/it][A
  8%|▊         | 4/49 [00:51<09:38, 12.85s/it][A
 10%|█         | 5/49 [01:03<09:19, 12.71s/it][A
 12%|█▏        | 6/49 [01:16<09:11, 12.82s/it][A
 14%|█▍        | 7/49 [01:30<09:17, 13.27s/it][A
 16%|█▋        | 8/49 [01:43<09:01, 13.22s/it][A
 18%|█▊        | 9/49 [01:57<08:49, 13.24s/it][A
 20%|██        | 10/49 [02:09<08:26, 13.00s/it][A
 22%|██▏       | 11/49 [02:21<08:04, 12.76s/it][A
 24%|██▍       | 12/49 [02:35<07:59, 12.96s/it][A
 27%|██▋       | 13/49 [02:47<07:37, 12.70s/it][A
 29%|██▊       | 14/49 [02:58<07:10, 12.31s/it][A
 31%|███       | 15/49 [03:12<07:09, 12.64s/it][A
 33%|███▎      | 16/49 [03:26<07:15, 13.21s/it][A
 35%|███▍      | 17/49 [03:39<07:00, 13.15s/it][A
 37%|███▋      | 18/49 [03:51<06:33, 12.71s/it][A
 39%|███▉      | 19/49 [04:03<06:19, 12.65s/it][A
 41%|████      | 20/49 [04:15<05:53, 12.19s/it][A
 43%|████▎     | 21/49 [04:27<05:41, 12.21s/it][A
 45%|████▍     | 22/49 [04:39<05:26, 12.09s/it][A
 47%|████▋     | 23/49 [04:51<05:16, 12.17s/it][A
 49%|████▉     | 24/49 [05:03<05:01, 12.06s/it][A
 51%|█████     | 25/49 [05:16<04:56, 12.36s/it][A
 53%|█████▎    | 26/49 [05:28<04:43, 12.32s/it][A
 55%|█████▌    | 27/49 [05:41<04:33, 12.42s/it][A
 57%|█████▋    | 28/49 [05:53<04:20, 12.40s/it][A
 59%|█████▉    | 29/49 [06:06<04:11, 12.58s/it][A
 61%|██████    | 30/49 [06:19<03:58, 12.57s/it][A
 63%|██████▎   | 31/49 [06:30<03:41, 12.30s/it][A
 65%|██████▌   | 32/49 [06:41<03:22, 11.89s/it][A
 67%|██████▋   | 33/49 [06:53<03:07, 11.73s/it][A
 69%|██████▉   | 34/49 [07:05<02:57, 11.84s/it][A
 71%|███████▏  | 35/49 [07:17<02:47, 11.99s/it][A
 73%|███████▎  | 36/49 [07:29<02:35, 11.97s/it][A
 76%|███████▌  | 37/49 [07:41<02:22, 11.90s/it][A
 78%|███████▊  | 38/49 [07:53<02:11, 11.96s/it][A
 80%|███████▉  | 39/49 [08:06<02:04, 12.41s/it][A
 82%|████████▏ | 40/49 [08:18<01:49, 12.21s/it][A
 84%|████████▎ | 41/49 [08:31<01:38, 12.31s/it][A
 86%|████████▌ | 42/49 [08:45<01:29, 12.83s/it][A
 88%|████████▊ | 43/49 [08:57<01:15, 12.63s/it][A
 90%|████████▉ | 44/49 [09:10<01:03, 12.68s/it][A
 92%|█████████▏| 45/49 [09:21<00:49, 12.46s/it][A
 94%|█████████▍| 46/49 [09:34<00:37, 12.49s/it][A
 96%|█████████▌| 47/49 [09:46<00:24, 12.42s/it][A
 98%|█████████▊| 48/49 [09:58<00:12, 12.12s/it][A
100%|██████████| 49/49 [10:10<00:00, 12.26s/it][A100%|██████████| 49/49 [10:10<00:00, 12.47s/it]
Generating new images...

  0%|          | 0/50 [00:00<?, ?it/s][A
  2%|▏         | 1/50 [01:09<57:06, 69.93s/it][A
  4%|▍         | 2/50 [02:20<56:00, 70.01s/it][A
  6%|▌         | 3/50 [03:30<54:55, 70.12s/it][A
  8%|▊         | 4/50 [04:40<53:48, 70.18s/it][A
 10%|█         | 5/50 [05:50<52:35, 70.12s/it][A
 12%|█▏        | 6/50 [07:01<51:31, 70.26s/it][A
 14%|█▍        | 7/50 [08:11<50:21, 70.27s/it][A
 16%|█▌        | 8/50 [09:21<49:12, 70.29s/it][A
 18%|█▊        | 9/50 [10:32<48:05, 70.39s/it][A
 20%|██        | 10/50 [11:42<46:57, 70.43s/it][A
 22%|██▏       | 11/50 [12:53<45:50, 70.51s/it][A
 24%|██▍       | 12/50 [14:03<44:37, 70.46s/it][A
 26%|██▌       | 13/50 [15:14<43:29, 70.53s/it][A
 28%|██▊       | 14/50 [16:25<42:21, 70.61s/it][A
 30%|███       | 15/50 [17:35<41:07, 70.49s/it][A
 32%|███▏      | 16/50 [18:45<39:54, 70.43s/it][A
 34%|███▍      | 17/50 [19:56<38:43, 70.40s/it][A
 36%|███▌      | 18/50 [21:06<37:30, 70.32s/it][A
 38%|███▊      | 19/50 [22:16<36:19, 70.31s/it][A
 40%|████      | 20/50 [23:26<35:08, 70.30s/it][A
 42%|████▏     | 21/50 [24:37<34:00, 70.36s/it][A
 44%|████▍     | 22/50 [25:47<32:49, 70.33s/it][A
 46%|████▌     | 23/50 [26:57<31:37, 70.26s/it][A
 48%|████▊     | 24/50 [28:08<30:27, 70.29s/it][A
 50%|█████     | 25/50 [29:18<29:16, 70.24s/it][A
 52%|█████▏    | 26/50 [30:28<28:07, 70.32s/it][A
 54%|█████▍    | 27/50 [31:38<26:55, 70.26s/it][A
 56%|█████▌    | 28/50 [32:49<25:45, 70.26s/it][A
 58%|█████▊    | 29/50 [33:59<24:35, 70.24s/it][A
 60%|██████    | 30/50 [35:09<23:25, 70.29s/it][A
 62%|██████▏   | 31/50 [36:20<22:15, 70.31s/it][A
 64%|██████▍   | 32/50 [37:30<21:05, 70.29s/it][A
 66%|██████▌   | 33/50 [38:40<19:54, 70.27s/it][A
 68%|██████▊   | 34/50 [39:50<18:45, 70.33s/it][A
 70%|███████   | 35/50 [41:01<17:34, 70.27s/it][A
 72%|███████▏  | 36/50 [42:11<16:23, 70.23s/it][A
 74%|███████▍  | 37/50 [43:08<14:21, 66.30s/it][A
 76%|███████▌  | 38/50 [43:50<11:47, 58.98s/it][A
 78%|███████▊  | 39/50 [44:32<09:53, 53.99s/it][A
 80%|████████  | 40/50 [45:15<08:25, 50.55s/it][A
 82%|████████▏ | 41/50 [45:57<07:11, 47.96s/it][A
 84%|████████▍ | 42/50 [46:39<06:09, 46.23s/it][A
 86%|████████▌ | 43/50 [47:21<05:14, 44.98s/it][A
 88%|████████▊ | 44/50 [48:03<04:24, 44.04s/it][A
 90%|█████████ | 45/50 [48:45<03:37, 43.46s/it][A
 92%|█████████▏| 46/50 [49:46<03:15, 48.86s/it][A
 94%|█████████▍| 47/50 [50:56<02:45, 55.26s/it][A
 96%|█████████▌| 48/50 [52:07<01:59, 59.82s/it][A
 98%|█████████▊| 49/50 [53:17<01:02, 62.97s/it][A
100%|██████████| 50/50 [54:27<00:00, 65.13s/it][A100%|██████████| 50/50 [54:27<00:00, 65.36s/it]
Total: 3884.766253709793s
 49%|████▉     | 23/47 [3:19:03<3:14:24, 486.02s/it]Extracting target objs from caption...
target_objs: [{'obj': 'person', 'num': 1, 'color': [128, 0, 0]}, {'obj': 'snowboard', 'num': 1, 'color': [0, 0, 192]}]
caption_objs: ['person', 'snow board']
Extracting target objs...
Adjusting layout...

  0%|          | 0/49 [00:00<?, ?it/s][A  0%|          | 0/49 [00:02<?, ?it/s]
--------error--------
Traceback (most recent call last):
  File "/home/wgy/multimodal/MuMo/run5.py", line 442, in <module>
    editor(image_dir=obj_image_path, output_path=mask_dir, step=10, gen_num=49)
  File "/home/wgy/multimodal/MuMo/layout_editor.py", line 203, in editor
    obj_list = get_obj_img(image_dir=image_dir, image_list=all_img)
  File "/home/wgy/multimodal/MuMo/layout_editor.py", line 133, in get_obj_img
    info = read_obj_info(mask)
  File "/home/wgy/multimodal/MuMo/layout_editor.py", line 119, in read_obj_info
    obj_info["x_max"] = max(point_x_set)
ValueError: max() arg is an empty sequence
---------------------
Total: 22.05368947982788s
 62%|██████▏   | 29/47 [3:19:25<1:32:51, 309.54s/it]Extracting target objs from caption...
target_objs: [{'obj': 'fire hydrant', 'num': 1, 'color': [192, 128, 0]}]
caption_objs: ['fire hydrant']
Extracting target objs...
Adjusting layout...

  0%|          | 0/49 [00:00<?, ?it/s][A
  2%|▏         | 1/49 [00:08<06:35,  8.24s/it][A
  4%|▍         | 2/49 [00:16<06:18,  8.05s/it][A
  6%|▌         | 3/49 [00:24<06:09,  8.04s/it][A
  8%|▊         | 4/49 [00:32<05:58,  7.98s/it][A
 10%|█         | 5/49 [00:40<05:51,  7.99s/it][A
 12%|█▏        | 6/49 [00:47<05:41,  7.94s/it][A
 14%|█▍        | 7/49 [00:56<05:35,  8.00s/it][A
 16%|█▋        | 8/49 [01:04<05:28,  8.02s/it][A
 18%|█▊        | 9/49 [01:11<05:19,  7.98s/it][A
 20%|██        | 10/49 [01:20<05:13,  8.05s/it][A
 22%|██▏       | 11/49 [01:28<05:05,  8.04s/it][A
 24%|██▍       | 12/49 [01:36<04:56,  8.03s/it][A
 27%|██▋       | 13/49 [01:44<04:47,  8.00s/it][A
 29%|██▊       | 14/49 [01:52<04:42,  8.08s/it][A
 31%|███       | 15/49 [02:00<04:33,  8.05s/it][A
 33%|███▎      | 16/49 [02:08<04:24,  8.02s/it][A
 35%|███▍      | 17/49 [02:16<04:15,  7.98s/it][A
 37%|███▋      | 18/49 [02:24<04:05,  7.92s/it][A
 39%|███▉      | 19/49 [02:31<03:57,  7.91s/it][A
 41%|████      | 20/49 [02:39<03:47,  7.85s/it][A
 43%|████▎     | 21/49 [02:47<03:41,  7.90s/it][A
 45%|████▍     | 22/49 [02:55<03:32,  7.87s/it][A
 47%|████▋     | 23/49 [03:03<03:28,  8.04s/it][A
 49%|████▉     | 24/49 [03:13<03:33,  8.54s/it][A
 51%|█████     | 25/49 [03:22<03:26,  8.60s/it][A
 53%|█████▎    | 26/49 [03:30<03:13,  8.42s/it][A
 55%|█████▌    | 27/49 [03:38<03:02,  8.28s/it][A
 57%|█████▋    | 28/49 [03:45<02:50,  8.11s/it][A
 59%|█████▉    | 29/49 [03:53<02:38,  7.92s/it][A
 61%|██████    | 30/49 [04:01<02:28,  7.83s/it][A
 63%|██████▎   | 31/49 [04:09<02:22,  7.90s/it][A
 65%|██████▌   | 32/49 [04:17<02:14,  7.92s/it][A
 67%|██████▋   | 33/49 [04:25<02:07,  7.94s/it][A
 69%|██████▉   | 34/49 [04:32<01:57,  7.85s/it][A
 71%|███████▏  | 35/49 [04:40<01:49,  7.85s/it][A
 73%|███████▎  | 36/49 [04:48<01:42,  7.91s/it][A
 76%|███████▌  | 37/49 [04:56<01:34,  7.88s/it][A
 78%|███████▊  | 38/49 [05:04<01:27,  7.93s/it][A
 80%|███████▉  | 39/49 [05:12<01:19,  7.97s/it][A
 82%|████████▏ | 40/49 [05:20<01:11,  7.91s/it][A
 84%|████████▎ | 41/49 [05:28<01:03,  7.98s/it][A
 86%|████████▌ | 42/49 [05:36<00:55,  7.98s/it][A
 88%|████████▊ | 43/49 [05:44<00:47,  7.99s/it][A
 90%|████████▉ | 44/49 [05:52<00:39,  7.97s/it][A
 92%|█████████▏| 45/49 [06:00<00:31,  7.95s/it][A
 94%|█████████▍| 46/49 [06:08<00:24,  8.02s/it][A
 96%|█████████▌| 47/49 [06:15<00:15,  7.82s/it][A
 98%|█████████▊| 48/49 [06:23<00:07,  7.86s/it][A
100%|██████████| 49/49 [06:31<00:00,  7.89s/it][A100%|██████████| 49/49 [06:31<00:00,  7.99s/it]
Generating new images...

  0%|          | 0/50 [00:00<?, ?it/s][A
  2%|▏         | 1/50 [01:10<57:16, 70.12s/it][A
  4%|▍         | 2/50 [02:20<56:01, 70.04s/it][A
  6%|▌         | 3/50 [03:30<54:54, 70.10s/it][A
  8%|▊         | 4/50 [04:40<53:39, 69.99s/it][A
 10%|█         | 5/50 [05:49<52:26, 69.92s/it][A
 12%|█▏        | 6/50 [06:59<51:18, 69.97s/it][A
 14%|█▍        | 7/50 [08:10<50:10, 70.01s/it][A
 16%|█▌        | 8/50 [09:20<49:00, 70.01s/it][A
 18%|█▊        | 9/50 [10:30<47:50, 70.01s/it][A
 20%|██        | 10/50 [11:40<46:42, 70.07s/it][A
 22%|██▏       | 11/50 [12:50<45:32, 70.07s/it][A
 24%|██▍       | 12/50 [14:00<44:23, 70.09s/it][A
 26%|██▌       | 13/50 [15:10<43:14, 70.11s/it][A
 28%|██▊       | 14/50 [16:20<42:03, 70.09s/it][A
 30%|███       | 15/50 [17:30<40:53, 70.09s/it][A
 32%|███▏      | 16/50 [18:40<39:39, 69.99s/it][A
 34%|███▍      | 17/50 [19:50<38:30, 70.00s/it][A
 36%|███▌      | 18/50 [21:00<37:20, 70.01s/it][A
 38%|███▊      | 19/50 [22:10<36:09, 69.98s/it][A
 40%|████      | 20/50 [23:20<35:01, 70.03s/it][A
 42%|████▏     | 21/50 [24:30<33:51, 70.06s/it][A
 44%|████▍     | 22/50 [25:40<32:40, 70.02s/it][A
 46%|████▌     | 23/50 [26:50<31:31, 70.06s/it][A
 48%|████▊     | 24/50 [28:00<30:20, 70.02s/it][A
 50%|█████     | 25/50 [29:10<29:09, 69.99s/it][A
 52%|█████▏    | 26/50 [30:20<28:00, 70.04s/it][A
 54%|█████▍    | 27/50 [31:30<26:51, 70.05s/it][A
 56%|█████▌    | 28/50 [32:40<25:41, 70.05s/it][A
 58%|█████▊    | 29/50 [33:50<24:30, 70.03s/it][A
 60%|██████    | 30/50 [35:01<23:20, 70.05s/it][A
 62%|██████▏   | 31/50 [36:11<22:10, 70.05s/it][A
 64%|██████▍   | 32/50 [37:21<21:00, 70.04s/it][A
 66%|██████▌   | 33/50 [38:31<19:52, 70.14s/it][A
 68%|██████▊   | 34/50 [39:41<18:42, 70.15s/it][A
 70%|███████   | 35/50 [40:41<16:45, 67.00s/it][A
 72%|███████▏  | 36/50 [41:23<13:54, 59.58s/it][A
 74%|███████▍  | 37/50 [42:05<11:45, 54.31s/it][A
 76%|███████▌  | 38/50 [42:47<10:07, 50.61s/it][A
 78%|███████▊  | 39/50 [43:29<08:48, 48.03s/it][A
 80%|████████  | 40/50 [44:11<07:42, 46.23s/it][A
 82%|████████▏ | 41/50 [44:53<06:44, 44.93s/it][A
 84%|████████▍ | 42/50 [45:35<05:52, 44.04s/it][A
 86%|████████▌ | 43/50 [46:17<05:04, 43.54s/it][A
 88%|████████▊ | 44/50 [47:00<04:18, 43.14s/it][A
 90%|█████████ | 45/50 [47:42<03:34, 42.84s/it][A
 92%|█████████▏| 46/50 [48:24<02:50, 42.60s/it][A
 94%|█████████▍| 47/50 [49:06<02:07, 42.45s/it][A
 96%|█████████▌| 48/50 [49:48<01:24, 42.27s/it][A
 98%|█████████▊| 49/50 [50:30<00:42, 42.19s/it][A
100%|██████████| 50/50 [51:31<00:00, 47.80s/it][A100%|██████████| 50/50 [51:31<00:00, 61.82s/it]
Total: 3511.359622001648s
 74%|███████▍  | 35/47 [4:17:56<1:20:50, 404.17s/it]Extracting target objs from caption...
target_objs: [{'obj': 'person', 'num': 1, 'color': [128, 0, 0]}, {'obj': 'cell phone', 'num': 0, 'color': [224, 0, 128]}]
caption_objs: ['lady', 'phone']
Extracting target objs...
Adjusting layout...

  0%|          | 0/49 [00:00<?, ?it/s][A  0%|          | 0/49 [00:02<?, ?it/s]
--------error--------
Traceback (most recent call last):
  File "/home/wgy/multimodal/MuMo/run5.py", line 442, in <module>
    editor(image_dir=obj_image_path, output_path=mask_dir, step=10, gen_num=49)
  File "/home/wgy/multimodal/MuMo/layout_editor.py", line 203, in editor
    obj_list = get_obj_img(image_dir=image_dir, image_list=all_img)
  File "/home/wgy/multimodal/MuMo/layout_editor.py", line 133, in get_obj_img
    info = read_obj_info(mask)
  File "/home/wgy/multimodal/MuMo/layout_editor.py", line 119, in read_obj_info
    obj_info["x_max"] = max(point_x_set)
ValueError: max() arg is an empty sequence
---------------------
Total: 29.20796275138855s
 87%|████████▋ | 41/47 [4:18:25<27:16, 272.79s/it]  Extracting target objs from caption...
target_objs: [{'obj': 'fruit', 'num': 0, 'color': [96, 192, 64]}]
caption_objs: ['fruit']
Extracting target objs...
Adjusting layout...

  0%|          | 0/49 [00:00<?, ?it/s][A
  2%|▏         | 1/49 [00:16<13:34, 16.97s/it][A
  4%|▍         | 2/49 [00:34<13:20, 17.03s/it][A
  6%|▌         | 3/49 [00:51<13:06, 17.09s/it][A
  8%|▊         | 4/49 [01:08<12:49, 17.10s/it][A
 10%|█         | 5/49 [01:25<12:32, 17.09s/it][A
 12%|█▏        | 6/49 [01:42<12:14, 17.07s/it][A
 14%|█▍        | 7/49 [01:59<11:58, 17.10s/it][A
 16%|█▋        | 8/49 [02:16<11:41, 17.10s/it][A
 18%|█▊        | 9/49 [02:33<11:24, 17.11s/it][A
 20%|██        | 10/49 [02:50<11:07, 17.12s/it][A
 22%|██▏       | 11/49 [03:08<10:50, 17.11s/it][A
 24%|██▍       | 12/49 [03:24<10:31, 17.06s/it][A
 27%|██▋       | 13/49 [03:42<10:13, 17.05s/it][A
 29%|██▊       | 14/49 [03:59<09:58, 17.10s/it][A
 31%|███       | 15/49 [04:16<09:41, 17.09s/it][A
 33%|███▎      | 16/49 [04:33<09:26, 17.16s/it][A
 35%|███▍      | 17/49 [04:50<09:08, 17.15s/it][A
 37%|███▋      | 18/49 [05:08<08:53, 17.21s/it][A
 39%|███▉      | 19/49 [05:25<08:35, 17.19s/it][A
 41%|████      | 20/49 [05:42<08:18, 17.18s/it][A
 43%|████▎     | 21/49 [05:59<08:01, 17.21s/it][A
 45%|████▍     | 22/49 [06:16<07:44, 17.19s/it][A
 47%|████▋     | 23/49 [06:34<07:27, 17.22s/it][A
 49%|████▉     | 24/49 [06:51<07:11, 17.28s/it][A
 51%|█████     | 25/49 [07:08<06:55, 17.30s/it][A
 53%|█████▎    | 26/49 [07:26<06:38, 17.32s/it][A
 55%|█████▌    | 27/49 [07:43<06:22, 17.36s/it][A
 57%|█████▋    | 28/49 [08:01<06:05, 17.38s/it][A
 59%|█████▉    | 29/49 [08:18<05:48, 17.40s/it][A
 61%|██████    | 30/49 [08:35<05:30, 17.39s/it][A
 63%|██████▎   | 31/49 [08:53<05:13, 17.42s/it][A
 65%|██████▌   | 32/49 [09:10<04:55, 17.41s/it][A
 67%|██████▋   | 33/49 [09:28<04:38, 17.44s/it][A
 69%|██████▉   | 34/49 [09:45<04:21, 17.42s/it][A
 71%|███████▏  | 35/49 [10:03<04:03, 17.40s/it][A
 73%|███████▎  | 36/49 [10:20<03:46, 17.40s/it][A
 76%|███████▌  | 37/49 [10:37<03:28, 17.38s/it][A
 78%|███████▊  | 38/49 [10:55<03:11, 17.40s/it][A
 80%|███████▉  | 39/49 [11:12<02:54, 17.43s/it][A
 82%|████████▏ | 40/49 [11:30<02:36, 17.42s/it][A
 84%|████████▎ | 41/49 [11:47<02:19, 17.41s/it][A
 86%|████████▌ | 42/49 [12:04<02:01, 17.41s/it][A
 88%|████████▊ | 43/49 [12:22<01:44, 17.41s/it][A
 90%|████████▉ | 44/49 [12:39<01:26, 17.32s/it][A
 92%|█████████▏| 45/49 [12:56<01:09, 17.25s/it][A
 94%|█████████▍| 46/49 [13:13<00:51, 17.22s/it][A
 96%|█████████▌| 47/49 [13:31<00:34, 17.29s/it][A
 98%|█████████▊| 48/49 [13:48<00:17, 17.45s/it][A
100%|██████████| 49/49 [14:08<00:00, 17.97s/it][A100%|██████████| 49/49 [14:08<00:00, 17.31s/it]
Generating new images...

  0%|          | 0/50 [00:00<?, ?it/s][A
  2%|▏         | 1/50 [01:10<57:37, 70.57s/it][A
  4%|▍         | 2/50 [02:20<56:23, 70.49s/it][A
  6%|▌         | 3/50 [03:31<55:14, 70.51s/it][A
  8%|▊         | 4/50 [04:42<54:04, 70.53s/it][A
 10%|█         | 5/50 [05:52<52:48, 70.42s/it][A
 12%|█▏        | 6/50 [07:02<51:39, 70.44s/it][A
 14%|█▍        | 7/50 [08:13<50:29, 70.45s/it][A
 16%|█▌        | 8/50 [09:23<49:18, 70.43s/it][A
 18%|█▊        | 9/50 [10:34<48:10, 70.49s/it][A
 20%|██        | 10/50 [11:44<46:57, 70.45s/it][A
 22%|██▏       | 11/50 [12:55<45:51, 70.54s/it][A
 24%|██▍       | 12/50 [14:06<44:43, 70.62s/it][A
 26%|██▌       | 13/50 [15:16<43:29, 70.53s/it][A
 28%|██▊       | 14/50 [16:26<42:18, 70.50s/it][A
 30%|███       | 15/50 [17:37<41:04, 70.42s/it][A
 32%|███▏      | 16/50 [18:47<39:57, 70.52s/it][A
 34%|███▍      | 17/50 [19:58<38:47, 70.54s/it][A
 36%|███▌      | 18/50 [21:09<37:38, 70.59s/it][A
 38%|███▊      | 19/50 [22:19<36:29, 70.63s/it][A
 40%|████      | 20/50 [23:30<35:17, 70.58s/it][A
 42%|████▏     | 21/50 [24:40<34:05, 70.55s/it][A
 44%|████▍     | 22/50 [25:51<32:56, 70.60s/it][A
 46%|████▌     | 23/50 [27:01<31:44, 70.53s/it][A
 48%|████▊     | 24/50 [28:12<30:33, 70.51s/it][A
 50%|█████     | 25/50 [29:22<29:21, 70.47s/it][A
 52%|█████▏    | 26/50 [30:33<28:11, 70.50s/it][A
 54%|█████▍    | 27/50 [31:43<27:01, 70.51s/it][A
 56%|█████▌    | 28/50 [32:37<23:58, 65.37s/it][A
 58%|█████▊    | 29/50 [33:19<20:26, 58.42s/it][A
 60%|██████    | 30/50 [34:02<17:53, 53.66s/it][A
 62%|██████▏   | 31/50 [34:44<15:55, 50.30s/it][A
 64%|██████▍   | 32/50 [35:27<14:24, 48.00s/it][A
 66%|██████▌   | 33/50 [36:09<13:08, 46.36s/it][A
 68%|██████▊   | 34/50 [36:52<12:03, 45.22s/it][A
 70%|███████   | 35/50 [37:34<11:05, 44.35s/it][A
 72%|███████▏  | 36/50 [38:16<10:12, 43.72s/it][A
 74%|███████▍  | 37/50 [38:59<09:23, 43.31s/it][A
 76%|███████▌  | 38/50 [39:41<08:35, 42.97s/it][A
 78%|███████▊  | 39/50 [40:23<07:51, 42.87s/it][A
 80%|████████  | 40/50 [41:06<07:07, 42.73s/it][A
 82%|████████▏ | 41/50 [41:48<06:24, 42.67s/it][A
 84%|████████▍ | 42/50 [42:31<05:41, 42.64s/it][A
 86%|████████▌ | 43/50 [43:13<04:58, 42.57s/it][A
 88%|████████▊ | 44/50 [43:56<04:15, 42.53s/it][A
 90%|█████████ | 45/50 [44:43<03:39, 43.87s/it][A
 92%|█████████▏| 46/50 [45:53<03:26, 51.68s/it][A
 94%|█████████▍| 47/50 [47:03<02:51, 57.25s/it][A
 96%|█████████▌| 48/50 [48:13<02:02, 61.20s/it][A
 98%|█████████▊| 49/50 [49:24<01:04, 64.04s/it][A
100%|██████████| 50/50 [50:34<00:00, 65.89s/it][A100%|██████████| 50/50 [50:34<00:00, 60.69s/it]
Total: 3912.0791342258453s
100%|██████████| 47/47 [5:23:37<00:00, 394.05s/it]100%|██████████| 47/47 [5:23:37<00:00, 413.14s/it]
Finish...
